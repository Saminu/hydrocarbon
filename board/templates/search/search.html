{% extends 'base.html' %}
{% load hc %}
{% load i18n %}

{% block title %}{% trans 'Search' %} :: {{ block.super }}{% endblock %}
{% block pagename %}{% trans 'Search' %}{% endblock %}

{% block content %}

<div class="section search">
	<div class="nav header">
		<div class="search button">
			<form action="." method="get">
				<input type="hidden" name="scope">
				<input type="submit" value="{% trans "Search" %}" class="search-button">
				{{ form.q }}
				<div class="dropdown container scope">
					<span class="handle label meta">
						<span class="icon"></span>
					</span>
					<div class="dropdown menu">
						<a href="#" class="close">{% trans "Close" %}</a>
						<div class="tip top"><span></span></div>
						{{ form.models }}
					</div>
				</div>
			</form>
		</div>

		<script>

			$('#id_models label input[type=checkbox]').each(function() {
				var $li = $(this).closest('li'),
					$label = $(this).closest('label');

				var $a = $('<a>')
					.attr('href', '#')
					.addClass('checkbox')
					.html('<span class="label"><span class="icon"></span><span class="text">' + $.trim($label.text()) + '</span></span>')
					.appendTo($li);

				if($(this).prop('checked')) $a.addClass('checked');

				$(this)
					.hide()
					.prependTo($li);

				$label.remove();
			});

			$('#id_models').on('click', 'a.checkbox', function() {
				var $checkbox = $(this).prev('input[type=checkbox]');

				$(this).toggleClass('checked');
				$checkbox.prop('checked', !$checkbox.prop('checked'));
			});

		</script>
	</div>

			{% if query %}
				<h3>Results</h3>

				{% for result in page.object_list %}
					<p>
						<a href="{{ result.object.get_absolute_url }}">{{ result.object.title }}</a>
					</p>
				{% empty %}
					<p>No results found.</p>
				{% endfor %}

				{% if page.has_previous or page.has_next %}
					<div>
						{% if page.has_previous %}<a href="?q={{ query }}&amp;page={{ page.previous_page_number }}">{% endif %}&laquo; Previous{% if page.has_previous %}</a>{% endif %}
						|
						{% if page.has_next %}<a href="?q={{ query }}&amp;page={{ page.next_page_number }}">{% endif %}Next &raquo;{% if page.has_next %}</a>{% endif %}
					</div>
				{% endif %}
			{% else %}
				{# Show some example queries to run, maybe query syntax, something else? #}
			{% endif %}

</div>

{% endblock %}
